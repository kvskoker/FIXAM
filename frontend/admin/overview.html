<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIXAM - Overview</title>

    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="Fixam" />
<link rel="manifest" href="/site.webmanifest" />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    
    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>

    <!-- Login Overlay -->
    <div id="login-overlay" class="login-overlay">
        <div class="login-card">
            <div style="margin-bottom: 1rem;">
                <img src="../fixam-logo-blue.svg" alt="FIXAM" height="80">
            </div>
           
            <form id="login-form" class="login-form">
                <input type="tel" id="admin-phone" placeholder="Phone Number" required>
                <div class="password-wrapper">
                    <input type="password" id="admin-password" placeholder="Password (Phone Number)" required>
                    <i class="fa-solid fa-eye password-toggle-icon" id="toggle-password"></i>
                </div>
                <button type="submit">Access Dashboard</button>
            </form>
            <p id="login-error" style="color: var(--admin-danger); margin-top: 1rem; display: none;">Invalid credentials</p>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-container" class="admin-container hidden">
        <aside class="admin-sidebar">
            <div class="admin-header-section">
                <img src="../fixam-logo.svg" alt="FIXAM" height="50" class="logo-full">
                <img src="../fixam-icon.svg" alt="FIXAM" height="40" class="logo-icon" style="display: none;">
                <button id="theme-toggle-admin" style="background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.3); color: white; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    <i class="fa-solid fa-moon"></i>
                </button>
            </div>
            <nav class="admin-nav">
                <a href="/admin/overview" id="nav-overview" class="admin-nav-item active">
                    <i class="fa-solid fa-chart-line"></i> <span>Overview</span>
                </a>
                <a href="/admin/issues" id="nav-issues" class="admin-nav-item">
                    <i class="fa-solid fa-triangle-exclamation"></i> <span>Issues</span>
                </a>
                <a href="/admin/users" id="nav-users" class="admin-nav-item">
                    <i class="fa-solid fa-users"></i> <span>Users & Groups</span>
                </a>
                <a href="/admin/feedback" id="nav-feedback" class="admin-nav-item">
                    <i class="fa-solid fa-comments"></i> <span>Feedback</span>
                </a>
                <div style="flex-grow: 1;"></div>
                <a href="#" id="logout-btn" class="admin-nav-item">
                    <i class="fa-solid fa-right-from-bracket"></i> <span>Logout</span>
                </a>
            </nav>
        </aside>

        <main class="admin-main">
            <!-- OVERVIEW VIEW -->
            <div id="view-overview">
                <div class="admin-header">
                    <div>
                        <h1>Government Dashboard</h1>
                        <p style="color: var(--admin-text-muted);">Real-time overview of citizen reports and infrastructure status</p>
                    </div>
                    <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                        <div id="admin-info"></div>
                    </div>
                </div>

                <!-- Global Filters -->
                <div class="filter-bar">
                    <div class="filter-group">
                        <label>Category:</label>
                        <select id="global-category-filter" class="filter-input">
                            <option value="All">All Categories</option>
                            <option value="Water">Water</option>
                            <option value="Road">Road</option>
                            <option value="Waste">Waste</option>
                            <option value="Electricity">Electricity</option>
                            <option value="Health">Health</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>From:</label>
                        <input type="date" id="global-date-start" class="filter-input">
                    </div>
                    <div class="filter-group">
                        <label>To:</label>
                        <input type="date" id="global-date-end" class="filter-input">
                    </div>

                    <button id="reset-filters" class="filter-btn">
                        Reset
                    </button>
                </div>

                <!-- Stats Row -->
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Reports</div>
                        <div class="stat-value" id="total-reports">--</div>
                        <div class="stat-trend trend-up">
                            <i class="fa-solid fa-arrow-trend-up"></i> <span id="reports-trend">--%</span> vs last week
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Resolved Issues</div>
                        <div class="stat-value" id="resolved-issues">--</div>
                        <div class="stat-trend trend-up">
                            <i class="fa-solid fa-check"></i> <span id="resolution-rate">--%</span> resolution rate
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Critical Pending</div>
                        <div class="stat-value" id="critical-pending" style="color: var(--admin-danger);">--</div>
                        <div class="stat-trend">
                            <span style="color: var(--admin-text-muted);">Requires immediate action</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">In Progress</div>
                        <div class="stat-value" id="in-progress-issues" style="color: var(--admin-warning);">--</div>
                        <div class="stat-trend" id="in-progress-trend">
                             <span style="color: var(--admin-text-muted);">Currently being worked on</span>
                        </div>
                    </div>
                </div>

                <!-- Charts & Map Row -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">Issue Hotspots</div>
                            <div style="font-size: 0.8rem; color: var(--admin-text-muted);">National Overview</div>
                        </div>
                        <div id="map-heatmap"></div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-header">
                            <div class="chart-title">Category Distribution</div>
                        </div>
                        <div style="position: relative; flex: 1; min-height: 0;">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Insight Cards -->
                <h2 style="margin-bottom: 1rem; font-family: 'Outfit', sans-serif;">AI Insights & Alerts</h2>
                <div class="insight-grid" id="insight-container">
                    <!-- Populated by JS -->
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script> 
    
    <!-- Flatpickr JS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script src="../js/theme.js"></script>
    <script src="../js/admin_common.js"></script>
    <script src="../js/admin_overview.js"></script>
</body>
</html>
